{% extends 'base.html' %}

{% block title %}Lista de Dueños{% endblock %}

{% block content %}
<h1>Lista de Dueños</h1>
<a href="{% url 'dueno_create' %}" class="btn btn-primary mb-3">Agregar Dueño</a>
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for dueno in duenos %}
        <tr>
            <td>{{ dueno.nombre }}</td>
            <td>
                <a href="{% url 'dueno_edit' dueno.pk %}" class="btn btn-warning btn-sm">Editar</a>
                <button class="btn btn-danger btn-sm" onclick="confirmDelete({{ dueno.pk }})">Eliminar</button>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'listar_encuentros' %}" class="btn btn-outline-secondary">
    <i class="bi bi-arrow-left me-1"></i>Volver al listado de encuentros
</a>
<a href="{% url 'crear_encuentro' %}" class="btn btn-secondary mt-3">Registrar encuentro</a>

<script>
    function confirmDelete(duenoId) {
        Swal.fire({
            title: '¿Estás seguro?',
            text: "¡Esta acción no se puede deshacer!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Eliminar',
            cancelButtonText: 'Cancelar',
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {
                // Si el usuario confirma, enviar el formulario POST para eliminar el dueño
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '';
                const csrfToken = document.createElement('input');
                csrfToken.type = 'hidden';
                csrfToken.name = 'csrfmiddlewaretoken';
                csrfToken.value = '{{ csrf_token }}';
                form.appendChild(csrfToken);
                const deleteInput = document.createElement('input');
                deleteInput.type = 'hidden';
                deleteInput.name = 'delete_dueno';
                deleteInput.value = duenoId;
                form.appendChild(deleteInput);
                document.body.appendChild(form);
                form.submit();
            }
        });
    }
</script>

{% endblock %}
